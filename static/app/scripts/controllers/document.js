// Generated by CoffeeScript 1.6.3
(function() {
  var controller;

  controller = function(scope, params, Service, timeout, http) {
    var id, load, removeFile;
    id = params.id;
    scope.text = '';
    scope.entity = {};
    scope.success = '';
    scope.error = '';
    Service.get(id, function(d) {
      return scope.$apply(function() {
        scope.entity = d;
        return load(d);
      });
    });
    removeFile = function(name) {
      var h;
      params = {
        method: 'POST',
        url: '/remove',
        data: {
          filename: name
        }
      };
      h = http(params);
      h.success(function(d) {
        scope.success = 'Removed successfully.';
        return timeout(function() {
          return scope.go('documents', 5000);
        });
      });
      return h.error(function(e) {
        scope.success = '';
        return scope.error = e;
      });
    };
    load = function(d) {
      var h;
      params = {
        method: 'POST',
        url: '/load',
        data: {
          filename: d.get('filename')
        }
      };
      h = http(params);
      h.success(function(d) {
        scope.text = d;
        scope.success = '';
        return scope.error = '';
      });
      return h.error(function(e) {
        scope.success = '';
        return scope.error = e;
      });
    };
    return scope.remove = function(e) {
      var filename, removeSuccess;
      filename = e.get('filename');
      removeSuccess = function() {
        return removeFile(filename);
      };
      return Service.remove(e, removeSuccess);
    };
  };

  angular.module('wordsApp').controller('DocumentCtrl', ['$scope', '$routeParams', 'Texts', '$timeout', '$http', controller]);

}).call(this);

/*
//@ sourceMappingURL=document.map
*/
